<!DOCTYPE html>
<html>
<head>
    <title>Heartbeat</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />
    <link rel="stylesheet" type="text/css" href="eap.css" />
    <link rel="shortcut icon" href="favicon.ico" />
    <script src="prototype.js" type="text/javascript" />
    <script type="text/javascript">
    function check(id) {
        var status
        new Ajax.PeriodicalUpdater('','http://localhost:8080/heartbeat', {
            method: 'get', frequency: Math.floor(Math.random() * 10) + 10,
            onCreate: function(response) {
                if (status == null) {
                    $(id).update('<img src="spinner.gif"/>');
                } else if (status.status == 'success') {
                    $(id).update('<img src="running_green.gif"/>');
                } else {
                    $(id).update('<img src="running_red.gif"/>');
                }
            },
            onSuccess: function(response) {
                setTimeout(function () {
                    status = response.responseText.evalJSON()
                    $(id).update('<img src="' + status.status + '.png" title="' + status.code + '"/>');
                }, 1000);
            }
         });
    }
    function heartbeat(){
    check('A')
    check('B')
    check('C')
    check('D')
    check('E')
    check('F')
    check('G')
    check('H')
    }
    </script>
</head>

<body onload="heartbeat()">
<h2>Modules</h2>
<ul>
<li><div id="A"><img src="spinner.gif"/></div></li>
<li><div id="B"><img src="spinner.gif"/></div></li>
<li><div id="C"><img src="spinner.gif"/></div></li>
<li><div id="D"><img src="spinner.gif"/></div></li>
<li><div id="E"><img src="spinner.gif"/></div></li>
<li><div id="F"><img src="spinner.gif"/></div></li>
<li><div id="G"><img src="spinner.gif"/></div></li>
<li><div id="H"><img src="spinner.gif"/></div></li>
</ul>
</body>
</html>